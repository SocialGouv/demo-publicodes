(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[504],{33602:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/algorithmes/[...algorithme]",function(){return n(33791)}])},33791:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSG:function(){return j},default:function(){return Algorithme}});var r=n(52322),l=n(36906),i=n(48283),s=n(11608),u=n(19678),o=n(25145),c=n(2784),a=n(66254),src_usePublicodesEngine=e=>{let t=null==e?void 0:e.situation,n=e.rule,r=e.rules,[l,i]=(0,c.useState)(null),[s,u]=(0,c.useState)(t),[o,d]=(0,c.useState)(null);(0,c.useEffect)(()=>{u({}),i(null);let e=new a.ZP(r);d(e)},[r]);let x=o&&o.evaluate(n),h=x&&Object.keys(x.missingVariables)||[];return null===l&&h.length&&i(h),{engine:o,evaluated:x,missingVariables:h,situation:s,setSituationValue:(e,t)=>{if(""===t){let t=s&&Object.keys(s).filter(t=>t!==e).reduce((e,t)=>({...e,[t]:s[t]}),{});u(t),o&&o.setSituation(t);return}if(isNaN(t)?"oui"===t||"non"===t||(t="'".concat(t,"'")):t=parseFloat(t),t){let n={...s,[e]:t};u(n),o&&o.setSituation(n)}},allMissingVariables:l}},d=n(39097),x=n.n(d);let AlgorithmeHeader=e=>{var t;let{meta:n}=e;return n&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{children:n.titre}),(0,r.jsx)("p",{dangerouslySetInnerHTML:{__html:(null===(t=n.description)||void 0===t?void 0:t.replace(/\n/g,"<br/>"))||""}}),n.références&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("b",{children:["Source",Object.keys(n.références).length>1?"s":"",":"]})," ",Object.keys(n.références).map(e=>(0,r.jsx)("li",{children:(0,r.jsx)("a",{href:n.références[e],children:e})},e))]})]})},DefaultForm=e=>{let{engine:t,rules:n,onChange:l,missingVariables:i,allMissingVariables:u}=e,getQuestion=e=>{let n=t&&t.getRule(e);return n&&n.rawNode.question||null};return u&&u.length&&u.map(e=>(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{style:{color:i.includes(e)?"red":"inherit"},children:getQuestion(e)||e}),(0,r.jsx)("br",{}),(0,r.jsx)(s.TextInput,{type:"text",style:{textAlign:"center",width:100},onBlur:t=>l(e,t.currentTarget.value)},"".concat(e)),(0,r.jsx)("hr",{})]},e))||null},h={epds:e=>{let{rules:t,engine:n,onChange:l,missingVariables:i,allMissingVariables:s}=e,u=Object.keys(t).filter(e=>e.match(/^question\d+$/)),getRule=e=>{let n=Object.entries(t).find(t=>{let[n,r]=t;return n===e});return n&&n[1]},getRulesRegexp=e=>Object.keys(t).filter(t=>t.match(e)).map(e=>t[e]);return(0,r.jsx)("div",{children:u.map(e=>{let t=getRule(e),n=getRulesRegexp(new RegExp("^".concat(e," . reponse\\d+$")));return t&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h5",{children:t.question}),n.map((t,n)=>(0,r.jsxs)("li",{children:[(0,r.jsx)("input",{type:"radio",name:e,onChange:n=>l("".concat(e," . reponse"),t.texte),id:"".concat(e,"-reponse").concat(n+1)}),(0,r.jsxs)("label",{htmlFor:"".concat(e,"-reponse").concat(n+1),children:["\xa0",t.texte]})]},t.texte)),(0,r.jsx)("br",{})]},e)})})},orientationCovid:e=>{let{rules:t,onChange:n,missingVariables:l,allMissingVariables:i,engine:u}=e,o=Object.keys(t).filter(e=>!!t[e].question),getRule=e=>{let n=Object.entries(t).find(t=>{let[n,r]=t;return n===e});return n&&n[1]},getQuestion=e=>{let t=getRule(e);return t&&t.question||null},isTextInput=e=>["patient . \xe2ge","patient . poids","patient . taille","sympt\xf4mes . temp\xe9rature"].includes(e);return(0,r.jsx)("div",{children:o&&o.length&&o.map(e=>(0,r.jsxs)("div",{children:[(0,r.jsx)("br",{}),isTextInput(e)?(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{style:{color:l.includes(e)?"red":"inherit"},children:getQuestion(e)||e}),(0,r.jsx)(s.TextInput,{type:"text",style:{textAlign:"center",width:100},onBlur:t=>n(e,t.currentTarget.value)},"orientation-covid-".concat(e))]}):(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"checkbox",onClick:t=>{t.currentTarget.checked?n(e,"oui"):n(e,"non")},id:"orientation-covid-".concat(e)}),(0,r.jsxs)("label",{htmlFor:"orientation-covid-".concat(e),style:{color:l.includes(e)?"red":"inherit"},children:["\xa0",getQuestion(e)||e]})]}),(0,r.jsx)("hr",{})]},e))||null})}};var j=!0;function Algorithme(e){var t,n,c;let{algorithme:a}=e,d=i.Z[(0,l.Z)(a[0])],j=d.rules,g=d.yaml,{engine:p,situation:b,evaluated:v,setSituationValue:m,missingVariables:f,allMissingVariables:y}=src_usePublicodesEngine({rules:j,rule:"r\xe9sultat",situation:{}}),_=p&&(null===(n=p.getParsedRules())||void 0===n?void 0:null===(t=n.meta)||void 0===t?void 0:t.rawNode),T=h[a]||DefaultForm;console.log({situation:b,missingVariables:f,allMissingVariables:y});let k=(null==v?void 0:null===(c=v.nodeValue)||void 0===c?void 0:c.toString().replace(/\n/g,"<br/>"))||"";return(0,r.jsxs)("div",{children:[(0,r.jsx)("br",{}),(0,r.jsx)(AlgorithmeHeader,{meta:_}),(0,r.jsx)("br",{}),(0,r.jsxs)(s.Tabs,{defaultActiveTab:0,children:[(0,r.jsx)(s.Tab,{label:"Formulaire",children:p&&(0,r.jsx)(T,{engine:p,missingVariables:f,allMissingVariables:y,rules:j,onChange:(e,t)=>m(e,t)})}),(0,r.jsxs)(s.Tab,{label:"Algorithme",children:["Editer sur"," ",(0,r.jsx)(x(),{target:"_blank",href:"https://publi.codes/studio/r\xe9sultat#".concat(encodeURIComponent(g)),children:"publi.codes/studio"}),(0,r.jsx)(u.Z,{language:"yaml",style:o.rJ,children:g})]}),(0,r.jsx)(s.Tab,{label:"Tests",children:"Todo: lancer les tests unitaires"})]}),k&&(0,r.jsx)(s.Alert,{title:"R\xe9sultat",type:"info",description:(0,r.jsx)("div",{style:{marginTop:15},dangerouslySetInnerHTML:{__html:k}})}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{})]})}}},function(e){e.O(0,[537,661,774,888,179],function(){return e(e.s=33602)}),_N_E=e.O()}]);